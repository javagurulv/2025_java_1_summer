# ‚ùå –ü–æ—á–µ–º—É –Ω–µ–ª—å–∑—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `double` –≤ —Ñ–∏–Ω–∞–Ω—Å–æ–≤—ã—Ö –≤—ã—á–∏—Å–ª–µ–Ω–∏—è—Ö –≤ Java

## üí° –ß—Ç–æ —Ç–∞–∫–æ–µ `double`?

–í Java —Ç–∏–ø `double` (—Å–æ–∫—Ä–∞—â–µ–Ω–∏–µ –æ—Ç *double precision floating point*)
‚Äî —ç—Ç–æ **—á–∏—Å–ª–æ —Å –ø–ª–∞–≤–∞—é—â–µ–π –∑–∞–ø—è—Ç–æ–π –¥–≤–æ–π–Ω–æ–π —Ç–æ—á–Ω–æ—Å—Ç–∏**, –∫–æ—Ç–æ—Ä–æ–µ
–∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è **–≤–µ—â–µ—Å—Ç–≤–µ–Ω–Ω—ã—Ö —á–∏—Å–µ–ª**
(–Ω–∞–ø—Ä–∏–º–µ—Ä, 3.14, 0.0001 –∏ —Ç.–¥.).

```java
double price = 10.99;
```

## üß† –ö–∞–∫ `double` —Ö—Ä–∞–Ω–∏—Ç —á–∏—Å–ª–∞?

`double` –∏—Å–ø–æ–ª—å–∑—É–µ—Ç **–¥–≤–æ–∏—á–Ω–æ–µ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏–µ**, –æ—Å–Ω–æ–≤–∞–Ω–Ω–æ–µ –Ω–∞
—Å—Ç–∞–Ω–¥–∞—Ä—Ç–µ IEEE 754. –≠—Ç–æ –æ–∑–Ω–∞—á–∞–µ—Ç, —á—Ç–æ **–Ω–µ –≤—Å–µ –¥–µ—Å—è—Ç–∏—á–Ω—ã–µ –¥—Ä–æ–±–∏
–º–æ–≥—É—Ç –±—ã—Ç—å —Ç–æ—á–Ω–æ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω—ã –≤ –ø–∞–º—è—Ç–∏**, —á—Ç–æ –ø—Ä–∏–≤–æ–¥–∏—Ç –∫
**–ø–æ–≥—Ä–µ—à–Ω–æ—Å—Ç—è–º –æ–∫—Ä—É–≥–ª–µ–Ω–∏—è**.

### –ü—Ä–∏–º–µ—Ä:

```java
double x = 0.1 + 0.2;
System.out.println(x); // –û–∂–∏–¥–∞–µ–º 0.3
```

–í—ã–≤–æ–¥ –±—É–¥–µ—Ç:

```
0.30000000000000004
```

–≠—Ç–æ –Ω–∞–∑—ã–≤–∞–µ—Ç—Å—è **–æ—à–∏–±–∫–∞ –æ–∫—Ä—É–≥–ª–µ–Ω–∏—è**, –∏ –æ–Ω–∞ –º–æ–∂–µ—Ç –∏—Å–ø–æ—Ä—Ç–∏—Ç—å
—Ä–µ–∑—É–ª—å—Ç–∞—Ç –ø—Ä–∏ –Ω–∞–∫–æ–ø–ª–µ–Ω–∏–∏ –æ—à–∏–±–æ–∫.

---

## üí∞ –ü–æ—á–µ–º—É —ç—Ç–æ –ø—Ä–æ–±–ª–µ–º–∞ –≤ —Ñ–∏–Ω–∞–Ω—Å–∞—Ö?

### –ü—Ä–µ–¥—Å—Ç–∞–≤—å—Ç–µ:

–£ –≤–∞—Å –µ—Å—Ç—å –±–∞–Ω–∫–æ–≤—Å–∫–∞—è —Å–∏—Å—Ç–µ–º–∞, –∏ –≤—ã —Å–∫–ª–∞–¥—ã–≤–∞–µ—Ç–µ –∫–æ–ø–µ–π–∫–∏, –∏—Å–ø–æ–ª—å–∑—É—è `double`:

```java
double balance = 0.0;
for (int i = 0; i < 100; i++) {
    balance += 0.01;
}
System.out.println(balance);
```

–í—ã–≤–æ–¥:

```
0.9999999999999999
```

–û–∂–∏–¥–∞–ª–∏ **1.00**, –Ω–æ –ø–æ–ª—É—á–∏–ª–∏ **–º–µ–Ω—å—à–µ** ‚Äî —ç—Ç–æ **—Ñ–∏–Ω–∞–Ω—Å–æ–≤–∞—è –∫–∞—Ç–∞—Å—Ç—Ä–æ—Ñ–∞**,
–æ—Å–æ–±–µ–Ω–Ω–æ –ø—Ä–∏ –º–∏–ª–ª–∏–æ–Ω–∞—Ö –æ–ø–µ—Ä–∞—Ü–∏–π.

---

# üìò IEEE 754 –∏ —Ç–∏–ø `double` –≤ Java

## üìê –ß—Ç–æ —Ç–∞–∫–æ–µ IEEE 754?

–≠—Ç–æ –º–µ–∂–¥—É–Ω–∞—Ä–æ–¥–Ω—ã–π **—Å—Ç–∞–Ω–¥–∞—Ä—Ç –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏—è —á–∏—Å–µ–ª —Å –ø–ª–∞–≤–∞—é—â–µ–π —Ç–æ—á–∫–æ–π** 
–≤ –¥–≤–æ–∏—á–Ω–æ–π —Ñ–æ—Ä–º–µ, –∏—Å–ø–æ–ª—å–∑—É–µ–º—ã–π –≤ –±–æ–ª—å—à–∏–Ω—Å—Ç–≤–µ —è–∑—ã–∫–æ–≤ –ø—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏—è, 
–≤–∫–ª—é—á–∞—è Java.

---

## üßÆ –§–æ—Ä–º–∞—Ç —á–∏—Å–ª–∞ —Ç–∏–ø–∞ `double`

`double` –≤ Java ‚Äî —ç—Ç–æ **64-–±–∏—Ç–Ω–æ–µ** (8 –±–∞–π—Ç) —á–∏—Å–ª–æ –≤ —Ñ–æ—Ä–º–∞—Ç–µ IEEE 754:

| –ë–∏—Ç | –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ           | –†–∞–∑–º–µ—Ä  |
| --- | -------------------- | ------- |
| 1   | –ó–Ω–∞–∫                 | 1 –±–∏—Ç   |
| 2   | –ü–æ—Ä—è–¥–æ–∫ (—ç–∫—Å–ø–æ–Ω–µ–Ω—Ç–∞) | 11 –±–∏—Ç  |
| 3   | –ú–∞–Ω—Ç–∏—Å—Å–∞ (–¥—Ä–æ–±—å)     | 52 –±–∏—Ç–∞ |

### –§–æ—Ä–º—É–ª–∞:

$$
\text{–ó–Ω–∞—á–µ–Ω–∏–µ} = (-1)^{\text{–∑–Ω–∞–∫}} \times 1.\text{–º–∞–Ω—Ç–∏—Å—Å–∞} \times 2^{\text{—ç–∫—Å–ø–æ–Ω–µ–Ω—Ç–∞} - 1023}
$$

> **–ú–∞–Ω—Ç–∏—Å—Å–∞** ‚Äî —ç—Ç–æ –∑–Ω–∞—á–∞—â–∞—è —á–∞—Å—Ç—å —á–∏—Å–ª–∞, 
–∞ **—ç–∫—Å–ø–æ–Ω–µ–Ω—Ç–∞** ‚Äî —Å—Ç–µ–ø–µ–Ω—å –¥–≤–æ–π–∫–∏, –∫–æ—Ç–æ—Ä–∞—è –º–∞—Å—à—Ç–∞–±–∏—Ä—É–µ—Ç —á–∏—Å–ª–æ.

---

## üîç –ü—Ä–∏–º–µ—Ä: `double x = 0.1;`

```java
double x = 0.1;
System.out.println(x);
```

**–û–∂–∏–¥–∞–µ–º:**

```
0.1
```

**–ù–∞ —Å–∞–º–æ–º –¥–µ–ª–µ –≤ –ø–∞–º—è—Ç–∏ —Ö—Ä–∞–Ω–∏—Ç—Å—è:**

```
0.1000000000000000055511151231257827021181583404541015625
```

–ü–æ—á–µ–º—É? –ü–æ—Ç–æ–º—É —á—Ç–æ **0.1 –Ω–µ –∏–º–µ–µ—Ç —Ç–æ—á–Ω–æ–≥–æ –¥–≤–æ–∏—á–Ω–æ–≥–æ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏—è**, 
–∫–∞–∫ –∏ 1/3 –Ω–µ –∏–º–µ–µ—Ç —Ç–æ—á–Ω–æ–≥–æ –¥–µ—Å—è—Ç–∏—á–Ω–æ–≥–æ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏—è (0.333...).

---

## üß† –ö–∞–∫ —ç—Ç–æ –≤—ã–≥–ª—è–¥–∏—Ç –≤ –±–∏—Ç–∞—Ö?

–í–æ—Ç —Ç–∞–∫ —Ö—Ä–∞–Ω–∏—Ç—Å—è `0.1` –∫–∞–∫ `double` –≤ 64 –±–∏—Ç–∞:

```
0 01111111011 1001100110011001100110011001100110011001100110011010
```

* **–ó–Ω–∞–∫** = 0 (–ø–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω–æ–µ —á–∏—Å–ª–æ)
* **–≠–∫—Å–ø–æ–Ω–µ–Ω—Ç–∞** = 1022 (–≤ –∑–∞–∫–æ–¥–∏—Ä–æ–≤–∞–Ω–Ω–æ–º –≤–∏–¥–µ 01111111011)
* **–ú–∞–Ω—Ç–∏—Å—Å–∞** ‚âà 0.10000000000000000555‚Ä¶

---

## ‚ùå –ü–æ—á–µ–º—É –≤–æ–∑–Ω–∏–∫–∞—é—Ç –æ—à–∏–±–∫–∏?

### –°—Ä–∞–≤–Ω–∏–º:

```java
System.out.println(0.1 + 0.2);  // 0.30000000000000004
System.out.println(0.1 * 3);    // 0.30000000000000004
System.out.println(0.3 == 0.1 + 0.2); // false
```

–•–æ—Ç—è –º–∞—Ç–µ–º–∞—Ç–∏—á–µ—Å–∫–∏ 0.1 + 0.2 = 0.3, —Ä–µ–∑—É–ª—å—Ç–∞—Ç **–Ω–µ —Ç–æ—á–µ–Ω**, 
–∏ Java –≤–∏–¥–∏—Ç **—Ä–∞–∑–Ω—ã–µ –±–∏—Ç–æ–≤—ã–µ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏—è**.

---

## üî¢ –ê–Ω–∞–ª–æ–≥–∏—è: –¥–µ—Å—è—Ç–∏—á–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞

–ï—Å–ª–∏ –±—ã –≤—ã —Ö—Ä–∞–Ω–∏–ª–∏ 1/3 –≤ –¥–µ—Å—è—Ç–∏—á–Ω–æ–π —Å–∏—Å—Ç–µ–º–µ:

```text
1 / 3 = 0.333333333333...
```

–í—ã –Ω–µ –º–æ–∂–µ—Ç–µ —Ç–æ—á–Ω–æ –∑–∞–ø–∏—Å–∞—Ç—å —ç—Ç–æ —á–∏—Å–ª–æ —Å –∫–æ–Ω–µ—á–Ω—ã–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ–º —Ü–∏—Ñ—Ä 
‚Äî **—Ç–æ –∂–µ —Å–∞–º–æ–µ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –≤ –¥–≤–æ–∏—á–Ω–æ–π —Å–∏—Å—Ç–µ–º–µ —Å 0.1 –∏ 0.2**.

---

## üìé –í—ã–≤–æ–¥

> `double` ‚Äî —ç—Ç–æ –±—ã—Å—Ç—Ä—ã–π, –Ω–æ **–Ω–µ —Ç–æ—á–Ω—ã–π** —Ç–∏–ø –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –¥—Ä–æ–±—è–º–∏. 
–û–Ω –∏–¥–µ–∞–ª—å–Ω–æ –ø–æ–¥—Ö–æ–¥–∏—Ç –¥–ª—è –Ω–∞—É—á–Ω—ã—Ö –∏ –∏–Ω–∂–µ–Ω–µ—Ä–Ω—ã—Ö –≤—ã—á–∏—Å–ª–µ–Ω–∏–π, 
–Ω–æ **–Ω–µ –¥–ª—è —Ñ–∏–Ω–∞–Ω—Å–æ–≤ –∏ –¥–µ–Ω–µ–∂–Ω—ã—Ö –æ–ø–µ—Ä–∞—Ü–∏–π**, –≥–¥–µ –≤–∞–∂–Ω–∞ 
**–∞–±—Å–æ–ª—é—Ç–Ω–∞—è —Ç–æ—á–Ω–æ—Å—Ç—å**.

---

#### –ü–æ–¥–¥–µ—Ä–∂–∫–∞, –≤–æ–ø—Ä–æ—Å—ã –∏ –æ–±—Ä–∞—Ç–Ω–∞—è —Å–≤—è–∑—å –ø–æ –ø—Ä–æ–µ–∫—Ç—É
* [–¢–µ–ª–µ–≥—Ä–∞–º–º –≥—Ä—É–ø–ø–∞ –ø—Ä–æ–µ–∫—Ç–∞](https://t.me/+mvRhG9YECTlkZjQ0)
* [–¢–µ–ª–µ–≥—Ä–∞–º–º –∞–≤—Ç–æ—Ä–∞ –∫—É—Ä—Å–∞] (@javagurulv)
* [–ï–º–µ–π–ª –∞–≤—Ç–æ—Ä–∞ –∫—É—Ä—Å–∞] (itguruby@mail.ru)
